<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Number Slot Machine 7x3</title>
<style>
body {
  font-family: 'Courier New', monospace;
  text-align: center;
  background: #111;
  color: #fff;
  padding-top: 20px;
}

h2 {
  font-size: 32px;
  text-shadow: 0 0 10px #ff0;
}

.grid {
  display: grid;
  grid-template-columns: repeat(7, 60px);
  gap: 8px;
  justify-content: center;
  margin: 20px auto;
}

.cell {
  font-size: 28px;
  padding: 15px;
  background: linear-gradient(#333, #111);
  border: 3px inset #555;
  border-radius: 12px;
  box-shadow: 0 0 8px #000 inset;
  transition: background 0.2s, color 0.2s;
}

.win {
  color: gold;
  text-shadow: 0 0 10px yellow;
  background: linear-gradient(#444, #222);
}

button {
  padding: 12px 25px;
  font-size: 18px;
  cursor: pointer;
  border-radius: 8px;
  background: linear-gradient(#666, #333);
  border: 2px solid #888;
  color: #fff;
  margin-top: 10px;
  box-shadow: 0 4px #000;
}

button:active {
  transform: translateY(2px);
  box-shadow: 0 2px #000;
}

table {
  margin: 20px auto;
  color: #fff;
  border-collapse: collapse;
  font-size: 16px;
}

table td, table th {
  border: 1px solid #888;
  padding: 6px 12px;
}
</style>
</head>

<body>
<h2>Number Slot Machine 7x3</h2>
<p>Credits: <span id="credits">10</span></p>

<div class="grid" id="grid"></div>

<button onclick="spin()">Spin</button>
<p id="result"></p>

<h3>Rules</h3>
<table>
<tr><td>3 × 7</td><td>+10 credits</td></tr>
<tr><td>3 × 3</td><td>+5 credits</td></tr>
<tr><td>Other 3 matches</td><td>+2 credits</td></tr>
</table>

<script>
let credits = 10;
const gridEl = document.getElementById("grid");
const rowsCount = 3;
const colsCount = 7;

function randomNum() {
  return Math.floor(Math.random() * 9) + 1;
}

function spin() {
  if (credits <= 0) {
    document.getElementById("result").innerText = "Out of credits.";
    return;
  }

  credits--;
  document.getElementById("credits").innerText = credits;
  gridEl.innerHTML = "";

  // Initialize 2D array
  let rows = Array.from({length: rowsCount}, () => []);

  // Generate final numbers
  const finalNumbers = Array.from({length: rowsCount * colsCount}, () => randomNum());

  let ticks = 10; // spin cycles

  function animateSpin(tick=0) {
    gridEl.innerHTML = "";
    for(let r=0; r<rowsCount; r++){
      for(let c=0; c<colsCount; c++){
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.innerText = tick < ticks ? randomNum() : finalNumbers[r*colsCount + c];
        gridEl.appendChild(cell);
        rows[r][c] = Number(cell.innerText);
      }
    }

    if(tick < ticks){
      setTimeout(()=>animateSpin(tick+1), 50);
    } else {
      checkWins();
    }
  }

  function checkWins() {
    let win = false;
    rows.forEach((row, rIdx) => {
      // Check for any 3 consecutive matching numbers in the row
      for(let i=0; i <= row.length - 3; i++){
        if(row[i] === row[i+1] && row[i+1] === row[i+2]){
          win = true;
          // assign credit based on number
          if(row[i] === 7) credits += 10;
          else if(row[i] === 3) credits += 5;
          else credits += 2;
          // highlight winning cells
          for(let j=0; j<3; j++){
            gridEl.children[rIdx*colsCount + i + j].classList.add("win");
          }
        }
      }
    });

    document.getElementById("credits").innerText = credits;
    document.getElementById("result").innerText = win ? "Match! Credits added!" : "No match";
  }

  animateSpin();
}
</script>
</body>
</html>
